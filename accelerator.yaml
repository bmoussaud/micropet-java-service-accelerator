accelerator:
  displayName: Micropet Java Service
  description: Tanzu Application Platform Accelerator to spin up a new service for the micropets app
  iconUrl: https://github.com/bmoussaud/micropet-java-service-accelerator/raw/main/pet-silhouette-icons.png
  tags:
    - java
    - spring
    - micropets
  options:
    - name: petKind
      label: "Kind"
      display: true
      defaultValue: Snake
      required: true
    - name: pkgName
      label: Package
      description: The name of the package
      dataType: string
      defaultValue: org.moussaud.micropets
engine:
  chain:
    - merge:
        - include: ["**"]
          exclude:
            [
              "pom.xml",
              "README.md",
              "grype.yaml",
              "kubernetes/**",
              "catalog/*.yaml",
              ".github/workflows/**",
            ]
        - include: ["pom.xml"]
          chain:
            - type: ReplaceText
              substitutions:
                - text: my-petservice
                  with: "#artifactId"
                - text: PetKind
                  with: "#petKind"
                - text: pkgName
                  with: "#pkgName"
        - include: ["src/main/java/**"]
          chain:
            - type: ReplaceText
              substitutions:
                - text: my-petservice
                  with: "#artifactId"
                - text: PetKind
                  with: "#petKind"
                - text: lowercasePetKind
                  with: "#petKind.toLowerCase()"
                - text: pkgName
                  with: "#pkgName"
        - include: ["**/*.java"]
          chain:
            - type: ReplaceText
              regex:
                pattern: com.renamethis
                with: "#pkgName"
            - type: OpenRewriteRecipe
              recipe: org.openrewrite.java.ChangePackage
              options:
                oldFullyQualifiedPackageName: "'com.renamethis'"
                newFullyQualifiedPackageName: "#pkgName"
                recursive: true
